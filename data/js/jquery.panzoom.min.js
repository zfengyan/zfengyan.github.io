(function(y,v){"object"===typeof exports&&"undefined"!==typeof module?module.exports=v():"function"===typeof define&&define.amd?define(v):(y="undefined"!==typeof globalThis?globalThis:y||self,y.Panzoom=v())})(this,function(){function y(b,c){for(var d=b.length;d--;)if(b[d].pointerId===c.pointerId)return d;return-1}function v(b,c){var d;if(c.touches)for(var w=d=0,g=c.touches;w<g.length;w++){var f=g[w];f.pointerId=d++;v(b,f)}else d=y(b,c),-1<d&&b.splice(d,1),b.push(c)}function T(b){b=b.slice(0);for(var c=b.pop(),d;d=b.pop();)c={clientX:(d.clientX-c.clientX)/2+c.clientX,clientY:(d.clientY-c.clientY)/2+c.clientY};return c}function N(b){if(2>b.length)return 0;var c=b[0];b=b[1];return Math.sqrt(Math.pow(Math.abs(b.clientX-c.clientX),2)+Math.pow(Math.abs(b.clientY-c.clientY),2))}function O(b,c,d,f){D[b].split(" ").forEach(function(b){c.addEventListener(b,d,f)})}function P(b,c,d){D[b].split(" ").forEach(function(b){c.removeEventListener(b,d)})}function z(b){if(t[b])return t[b];var c;c=A?A:A=document.createElement("div").style;if(b in c)return t[b]=b;for(var d=b[0].toUpperCase()+b.slice(1),f=E.length;f--;){var g=""+E[f]+d;if(g in c)return t[b]=g}}function u(b,c,d){void 0===d&&(d=window.getComputedStyle(b));b="border"===c?"Width":"";return{left:parseFloat(d[z(c+"Left"+b)])||0,right:parseFloat(d[z(c+"Right"+b)])||0,top:parseFloat(d[z(c+"Top"+b)])||0,bottom:parseFloat(d[z(c+"Bottom"+b)])||0}}function B(b,c,d){b.style[z(c)]=d}function Q(b){var c=b.parentNode,d=window.getComputedStyle(b),f=window.getComputedStyle(c),g=b.getBoundingClientRect(),q=c.getBoundingClientRect();return{elem:{style:d,width:g.width,height:g.height,top:g.top,bottom:g.bottom,left:g.left,right:g.right,margin:u(b,"margin",d),border:u(b,"border",d)},parent:{style:f,width:q.width,height:q.height,top:q.top,bottom:q.bottom,left:q.left,right:q.right,padding:u(c,"padding",f),border:u(c,"border",f)}}}function Y(b){var c=b.ownerDocument;b=b.parentNode;return c&&b&&9===c.nodeType&&1===b.nodeType&&c.documentElement.contains(b)}function Z(b){return aa.test(b.namespaceURI)&&"svg"!==b.nodeName.toLowerCase()}function F(b,c){function d(a,c,h){h.silent||(a=new CustomEvent(a,{detail:c}),b.dispatchEvent(a))}function w(a,c,h){var e={x:n,y:p,scale:l,isSVG:C,originalEvent:h};requestAnimationFrame(function(){if("boolean"===typeof c.animate)if(c.animate){var m=z("transform");B(b,"transition",m+" "+c.duration+"ms "+c.easing)}else B(b,"transition","none");c.setTransform(b,e,c);d(a,e,c);d("panzoomchange",e,c)});return e}function g(){if(c.contain){var a=Q(b),e=(a.parent.width-a.parent.border.left-a.parent.border.right)/(a.elem.width/l),a=(a.parent.height-a.parent.border.top-a.parent.border.bottom)/(a.elem.height/l);"inside"===c.contain?c.maxScale=Math.min(e,a):"outside"===c.contain&&(c.minScale=Math.max(e,a))}}function q(a,e,h,d){var m=f(f({},c),d);d={x:n,y:p,opts:m};if(!m.force&&(m.disablePan||m.panOnlyWhenZoomed&&l===m.startScale))return d;a=parseFloat(a);e=parseFloat(e);m.disableXAxis||(d.x=(m.relative?n:0)+a);m.disableYAxis||(d.y=(m.relative?p:0)+e);if(m.contain){a=Q(b);var g=a.elem.width/l,x=a.elem.height/l,k=g*h;e=x*h;g=(k-g)/2;x=(e-x)/2;"inside"===m.contain?(m=(-a.elem.margin.left-a.parent.padding.left+g)/h,k=(a.parent.width-k-a.parent.padding.left-a.elem.margin.left-a.parent.border.left-a.parent.border.right+g)/h,d.x=Math.max(Math.min(d.x,k),m),m=(-a.elem.margin.top-a.parent.padding.top+x)/h,h=(a.parent.height-e-a.parent.padding.top-a.elem.margin.top-a.parent.border.top-a.parent.border.bottom+x)/h,d.y=Math.max(Math.min(d.y,h),m)):"outside"===m.contain&&(m=(-(k-a.parent.width)-a.parent.padding.left-a.parent.border.left-a.parent.border.right+g)/h,k=(g-a.parent.padding.left)/h,d.x=Math.max(Math.min(d.x,k),m),m=(-(e-a.parent.height)-a.parent.padding.top-a.parent.border.top-a.parent.border.bottom+x)/h,h=(x-a.parent.padding.top)/h,d.y=Math.max(Math.min(d.y,h),m))}return d}function t(a,b){var e=f(f({},c),b),d={scale:l,opts:e};if(!e.force&&e.disableZoom)return d;d.scale=Math.min(Math.max(a,e.minScale),e.maxScale);return d}function u(a,c,b,d){a=q(a,c,l,b);return n!==a.x||p!==a.y?(n=a.x,p=a.y,w("panzoompan",a.opts,d)):{x:n,y:p,scale:l,isSVG:C,originalEvent:d}}function H(a,c,b){a=t(a,c);c=a.opts;if(c.force||!c.disableZoom){a=a.scale;var d=n,e=p;c.focal&&(e=c.focal,d=(e.x/a-e.x/l+n*a)/a,e=(e.y/a-e.y/l+p*a)/a);d=q(d,e,a,{relative:!1,force:!0});n=d.x;p=d.y;l=a;return w("panzoomzoom",c,b)}}function A(a,b){var d=f(f(f({},c),{animate:!0}),b);return H(l*Math.exp((a?1:-1)*d.step),d)}function R(a,c,d,g){var e=Q(b),h=e.parent.width-e.parent.padding.left-e.parent.padding.right-e.parent.border.left-e.parent.border.right,k=e.parent.height-e.parent.padding.top-e.parent.padding.bottom-e.parent.border.top-e.parent.border.bottom,n=c.clientX-e.parent.left-e.parent.padding.left-e.parent.border.left-e.elem.margin.left;c=c.clientY-e.parent.top-e.parent.padding.top-e.parent.border.top-e.elem.margin.top;C||(n-=e.elem.width/l/2,c-=e.elem.height/l/2);e={x:n/h*h*a,y:c/k*k*a};return H(a,f(f({animate:!1},d),{focal:e}),g)}function E(a){var b;a:{b=c;for(var h=a.target;null!=h;h=h.parentNode){var f=b.excludeClass;if(1===h.nodeType&&-1<(" "+(h.getAttribute("class")||"").trim()+" ").indexOf(" "+f+" ")||-1<b.exclude.indexOf(h)){b=!0;break a}}b=!1}b||(v(r,a),I=!0,c.handleStartEvent(a),J=n,K=p,b=T(r),L=b.clientX,M=b.clientY,U=l,G=N(r),0<G&&d("panzoomstart",{x:n,y:p,scale:l,isSVG:C,originalEvent:a},c))}function F(a){if(I&&void 0!==J&&void 0!==K&&void 0!==L&&void 0!==M){v(r,a);var b=T(r);1<r.length?(0===G&&(G=N(r)),a=N(r)-G,a=t(a*c.step/80+U).scale,R(a,b)):u(J+(b.clientX-L)/l,K+(b.clientY-M)/l,{animate:!1},a)}}function V(a){2===r.length&&d("panzoomend",{x:n,y:p,scale:l,isSVG:C,originalEvent:a},c);var b=r;if(a.touches)for(;b.length;)b.pop();else a=y(b,a),-1<a&&b.splice(a,1);I&&(I=!1,J=K=L=M=void 0)}function W(){S||(S=!0,O("down",c.canvas?k:b,E),O("move",document,F,{passive:!0}),O("up",document,V,{passive:!0}))}if(!b)throw Error("Panzoom requires an element as an argument");if(1!==b.nodeType)throw Error("Panzoom requires an element with a nodeType of 1");if(!Y(b))throw Error("Panzoom should be called on elements that have been attached to the DOM");c=f(f({},X),c);var C=Z(b),k=b.parentNode;k.style.overflow=c.overflow;k.style.userSelect="none";k.style.touchAction=c.touchAction;(c.canvas?k:b).style.cursor=c.cursor;b.style.userSelect="none";b.style.touchAction=c.touchAction;B(b,"transformOrigin","string"===typeof c.origin?c.origin:C?"0 0":"50% 50%");var n=0,p=0,l=1,I=!1;H(c.startScale,{animate:!1,force:!0});setTimeout(function(){g();u(c.startX,c.startY,{animate:!1,force:!0})});var J,K,L,M,U,G,r=[],S=!1;c.noBind||W();return{bind:W,destroy:function(){S=!1;P("down",c.canvas?k:b,E);P("move",document,F);P("up",document,V)},eventNames:D,getPan:function(){return{x:n,y:p}},getScale:function(){return l},getOptions:function(){var a=c,b={},d;for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b},pan:u,reset:function(a){a=f(f(f({},c),{animate:!0,force:!0}),a);l=t(a.startScale,a).scale;var b=q(a.startX,a.startY,l,a);n=b.x;p=b.y;return w("panzoomreset",a)},resetStyle:function(){k.style.overflow="";k.style.userSelect="";k.style.touchAction="";k.style.cursor="";b.style.cursor="";b.style.userSelect="";b.style.touchAction="";B(b,"transformOrigin","")},setOptions:function(a){void 0===a&&(a={});for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);if(a.hasOwnProperty("cursor")||a.hasOwnProperty("canvas"))k.style.cursor=b.style.cursor="",(c.canvas?k:b).style.cursor=c.cursor;a.hasOwnProperty("overflow")&&(k.style.overflow=a.overflow);a.hasOwnProperty("touchAction")&&(k.style.touchAction=a.touchAction,b.style.touchAction=a.touchAction);(a.hasOwnProperty("minScale")||a.hasOwnProperty("maxScale")||a.hasOwnProperty("contain"))&&g()},setStyle:function(a,c){return B(b,a,c)},zoom:H,zoomIn:function(a){return A(!0,a)},zoomOut:function(a){return A(!1,a)},zoomToPoint:R,zoomWithWheel:function(a,b){var d=f(f(f({},c),b),{animate:!1}),e=t(l*Math.exp((0>(0===a.deltaY&&a.deltaX?a.deltaX:a.deltaY)?1:-1)*d.step/3),d).scale;return R(e,a,d)}}}var f=function(){f=Object.assign||function(b){for(var c,d=1,f=arguments.length;d<f;d++){c=arguments[d];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(b[g]=c[g])}return b};return f.apply(this,arguments)};"undefined"!==typeof window&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!==typeof window.CustomEvent&&(window.CustomEvent=function(b,c){c=c||{bubbles:!1,cancelable:!1,detail:null};var d=document.createEvent("CustomEvent");d.initCustomEvent(b,c.bubbles,c.cancelable,c.detail);return d}));var D={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};"undefined"!==typeof window&&("function"===typeof window.PointerEvent?D={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:"function"===typeof window.TouchEvent&&(D={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));var ba="undefined"!==typeof document&&!!document.documentMode,A,E=["webkit","moz","ms"],t={},aa=/^http:[\w\.\/]+svg$/,X={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",handleStartEvent:function(b){},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!1,relative:!1,setTransform:function(b,c,d){d=c.isSVG;B(b,"transform","scale("+c.scale+") translate("+c.x+"px, "+c.y+"px)");d&&ba&&(c=window.getComputedStyle(b).getPropertyValue("transform"),b.setAttribute("transform",c))},startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};F.defaultOptions=X;return F});